@page "/db"
@rendermode InteractiveServer
@using WagerMate.Data
@using WagerMate.Services
@using WagerMate.Services.impl
<PageTitle>Database</PageTitle>
<h3>Database</h3>

<p>This page displays data from Postgresdb</p>

@inject IUserService service;

<button class="btn btn-primary" @onclick="DeleteUser">DeleteUser</button>
<button class="btn btn-primary" @onclick="CreateUser">CreateUser</button>
<button class="btn btn-primary" @onclick="CreateUser2">CreateUser2</button>
<button class="btn btn-primary" @onclick="GetAllUsers">getAllUsers(Console)</button>
<button class="btn btn-primary" @onclick="UpdateUser">UpdateUser</button>
<button class="btn btn-primary" @onclick="GetUserByIDConsole">GetUserByIDConsole</button>
@code {

    public void GetUserByIDConsole()
    {
        try
        {
            var result = service.GetUserByID(50);
            Console.WriteLine(result.Name);
        }
        catch (Exception e)
        {
            Console.WriteLine("Getuserbyid failed");
            Console.WriteLine(e);
            
        }
    }

    public void UpdateUser()
    {
        User updatedU = new User();
        updatedU.Name = "update";
        updatedU.Email = "updat@email";
        updatedU.Password = "updatedPW";
        updatedU.Id = 50;
        
        var result = service.UpdateUser(updatedU);
        Console.WriteLine($"Updating User succesful: {result}");
    }
    
    private void GetAllUsers()
    {
        Console.WriteLine("Get ALl Users executing: ");
        var result = service.GetAllUsers();
        foreach (var user in result)
        {
            Console.WriteLine(user.Name);
        }
    }
    private void DeleteUser()
    {
        Console.WriteLine("DeleteUser");
        service.DeleteUser(40);
    }
    
    private void CreateUser()
    {
        Console.WriteLine("CreateUser");
        service.CreateUser(init());
    }
    private void CreateUser2()
    {
        Console.WriteLine("CreateUser2");
        // create dummy user
        User user2 = new User();
        user2.Name = "user2";
        user2.Email = "user2@gmail.com";
        user2.Password = "12345";
        
        Console.WriteLine("user locally created");
        try
        {
            service.CreateUser(user2);
        }
        catch (Exception e)
        {
            Console.WriteLine("service failldasdjmlksa");
            
        }
    }
    
    public User init()
    {
        User user = new User();
        user.Name = "tobi";
        user.Email = "tobi@gmail.com";
        user.Password = "1234";
        return user;
    }
}